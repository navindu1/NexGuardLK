<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - NexGuard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: "Inter", sans-serif;
        color: #e0e0e0;
        background-color: #020010;
      }
      #vanta-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
      }
      #app-container {
        position: relative;
        z-index: 1;
      }
      .glass-panel {
        background: rgba(10, 8, 28, 0.75);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .btn {
        padding: 8px 14px;
        border-radius: 6px;
        font-weight: 600;
        transition: all 0.2s;
        font-size: 13px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      .btn-approve {
        background-color: #166534;
        color: #bbf7d0;
      }
      .btn-approve:hover:not(:disabled) {
        background-color: #15803d;
      }
      .btn-reject {
        background-color: #991b1b;
        color: #fecaca;
      }
      .btn-reject:hover:not(:disabled) {
        background-color: #b91c1c;
      }
      .btn-ban {
        background-color: #9a3412;
        color: #fdba74;
      }
      .btn-ban:hover:not(:disabled) {
        background-color: #c2410c;
      }
      .btn-view {
        background-color: #1e3a8a;
        color: #bfdbfe;
      }
      .btn-view:hover:not(:disabled) {
        background-color: #1e40af;
      }
      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .modal {
        display: none;
      }
      .modal.active {
        display: flex;
      }

      @media (max-width: 767px) {
        .responsive-table thead {
          display: none;
        }
        .responsive-table tr {
          display: block;
          margin-bottom: 1rem;
          border-radius: 0.75rem;
          border: 1px solid rgba(255, 255, 255, 0.1);
          padding: 1rem;
          background: rgba(255, 255, 255, 0.05);
        }
        .responsive-table td {
          display: grid;
          grid-template-columns: 120px 1fr;
          gap: 1rem;
          align-items: center;
          padding: 0.6rem 0;
          text-align: left;
          border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }
        .responsive-table td:last-child {
          border-bottom: none;
        }
        .responsive-table td::before {
          content: attr(data-label);
          font-weight: 600;
          color: #9ca3af;
        }
        .responsive-table .actions-cell {
          grid-template-columns: 1fr;
        }
        .responsive-table .actions-cell::before {
          display: none;
        }
      }
      .toggle-checkbox:checked {
        right: 0;
        border-color: #a78bfa;
      }
      .toggle-checkbox:checked + .toggle-label {
        background-color: #a78bfa;
      }
      .connection-card {
        background: rgba(10, 8, 28, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        margin-bottom: 1.5rem;
        overflow: hidden;
      }
      .connection-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      .connection-title h3 {
        font-size: 1.125rem;
        font-weight: 700;
        color: #ffffff;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      .connection-title .type-badge {
        font-size: 0.75rem;
        font-weight: 500;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        color: #e0e0e0;
      }
      .type-badge.single-package {
        background-color: rgba(59, 130, 246, 0.2);
        color: #93c5fd;
      }
      .type-badge.multi-package {
        background-color: rgba(168, 85, 247, 0.2);
        color: #d8b4fe;
      }
      .details-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }
      .detail-item {
        background: rgba(0, 0, 0, 0.2);
        padding: 0.75rem 1rem;
        border-radius: 8px;
      }
      .detail-item .label {
        font-size: 0.75rem;
        color: #9ca3af;
        margin-bottom: 0.25rem;
      }
      .detail-item .value {
        font-size: 0.9rem;
        font-weight: 600;
        color: #ffffff;
        word-break: break-all;
      }
      .package-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }
      .connection-header {
        cursor: pointer;
      }
      .connection-body {
        max-height: 0;
        overflow: hidden;
        padding-top: 0;
        padding-bottom: 0;
        transition: max-height 0.5s cubic-bezier(0.25, 0.8, 0.25, 1),
          padding 0.5s ease-in-out;
      }
      .connection-body.expanded {
        max-height: 1000px; /* Increased to accommodate content */
        padding: 1.5rem;
      }
      .collapse-icon {
        transition: transform 0.4s ease;
      }
      .connection-header:not(.collapsed) .collapse-icon {
        transform: rotate(90deg);
      }
      .package-item {
        display: flex;
        flex-wrap: wrap; /* Allow wrapping on small screens */
        align-items: center;
        gap: 1rem;
        padding: 0.75rem 1.25rem;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        transition: background-color 0.2s;
      }
      .package-item:hover {
        background: rgba(0, 0, 0, 0.4);
      }
      .package-item .name {
        flex-grow: 1;
        font-weight: 600;
        color: #ffffff;
        min-width: 120px;
      }
      .package-item .inbound {
        font-family: monospace;
        color: #a5b4fc;
        min-width: 100px;
      }
      .package-item .template-display {
        flex-grow: 2;
        min-width: 150px;
      }
      .package-item .actions {
        display: flex;
        gap: 0.5rem;
        justify-content: flex-end;
      }
      .template-display .template-text {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 6px;
        padding: 0.3rem 0.5rem;
        font-family: monospace;
        font-size: 0.7rem;
        color: #a5b4fc;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
      }
      
      /* **** START: NEW TOAST MESSAGE CSS **** */
      #toast-container {
        position: fixed;
        top: 1.25rem;
        right: 1.25rem;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        width: 100%;
        max-width: 350px;
      }

      .toast {
        display: flex;
        align-items: flex-start;
        padding: 0.75rem;
        border-radius: 8px;
        background: rgba(30, 27, 75, 0.9);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.15);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        color: #e0e0e0;
        position: relative;
        overflow: hidden;
        transform: translateX(120%);
        opacity: 0;
        transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.4s ease-out;
      }

      .toast.show { transform: translateX(0); opacity: 1; }
      .toast::before { content: ""; position: absolute; top: 0; left: 0; bottom: 0; width: 4px; border-radius: 8px 0 0 8px; }
      .toast--success::before { background-color: #22c55e; }
      .toast--error::before { background-color: #ef4444; }
      .toast--warning::before { background-color: #f97316; }
      .toast--info::before { background-color: #3b82f6; }
      .toast-icon { flex-shrink: 0; margin-right: 0.75rem; font-size: 1.125rem; width: 22px; text-align: center; margin-top: 1px; }
      .toast--success .toast-icon { color: #22c55e; }
      .toast--error .toast-icon { color: #ef4444; }
      .toast--warning .toast-icon { color: #f97316; }
      .toast--info .toast-icon { color: #3b82f6; }
      .toast-content { flex-grow: 1; }
      .toast-title { font-weight: 700; font-size: 0.9rem; margin: 0 0 0.2rem 0; color: #ffffff; }
      .toast-message { font-size: 0.8rem; line-height: 1.4; margin: 0; color: #d1d5db; }
      .toast-close-btn { flex-shrink: 0; margin-left: 0.75rem; background: transparent; border: none; color: #9ca3af; font-size: 1.25rem; line-height: 1; cursor: pointer; transition: color 0.2s ease; }
      .toast-close-btn:hover { color: #ffffff; }
      /* **** END: NEW TOAST MESSAGE CSS **** */

    </style>
  </head>
  <body class="p-4 sm:p-6 lg:p-8">
    <div id="vanta-bg"></div>
    <div id="app-container" class="max-w-7xl mx-auto">
      <header
        class="flex flex-col sm:flex-row justify-between sm:items-center py-4 mb-8 gap-4"
      >
        <h1 class="text-3xl font-bold font-['Orbitron'] text-white">
          Admin Dashboard
        </h1>
        <div class="flex items-center gap-4 self-end sm:self-center">
          <button
            id="settings-btn"
            class="text-sm font-semibold text-slate-400 hover:text-white transition-colors"
          >
            <i class="fa-solid fa-cog"></i>
            <span class="hidden sm:inline ml-2">Settings</span>
          </button>
          <button
            id="logout-btn"
            class="text-sm font-semibold text-slate-400 hover:text-white transition-colors"
          >
            <span class="hidden sm:inline">Logout</span>
            <i class="fa-solid fa-right-from-bracket ml-2"></i>
          </button>
        </div>
      </header>
      <section
  id="stats-section"
  class="grid grid-cols-2 lg:grid-cols-7 gap-4 sm:gap-6 mb-8"
>
  <div
    id="card-pending"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-amber-400"
  >
    <div
      class="bg-amber-500/10 text-amber-400 p-3 rounded-lg hidden sm:block"
    >
      <i class="fa-solid fa-clock fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Pending</p>
      <h3
        id="pending-orders-stat"
        class="text-xl sm:text-2xl font-bold text-white"
      >
        0
      </h3>
    </div>
  </div>
  <div id="card-unconfirmed" class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-orange-400">
    <div class="bg-orange-500/10 text-orange-400 p-3 rounded-lg hidden sm:block">
      <i class="fa-solid fa-robot fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Unconfirmed</p>
      <h3 id="unconfirmed-orders-stat" class="text-xl sm:text-2xl font-bold text-white">0</h3>
    </div>
  </div>
  <div
    id="card-approved"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-green-400"
  >
    <div
      class="bg-green-500/10 text-green-400 p-3 rounded-lg hidden sm:block"
    >
      <i class="fa-solid fa-check-circle fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Approved</p>
      <h3
        id="approved-orders-stat"
        class="text-xl sm:text-2xl font-bold text-white"
      >
        0
      </h3>
    </div>
  </div>
  <div
    id="card-rejected"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-red-400"
  >
    <div
      class="bg-red-500/10 text-red-400 p-3 rounded-lg hidden sm:block"
    >
      <i class="fa-solid fa-times-circle fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Rejected</p>
      <h3
        id="rejected-orders-stat"
        class="text-xl sm:text-2xl font-bold text-white"
      >
        0
      </h3>
    </div>
  </div>
  <div
    id="card-users"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-sky-400"
  >
    <div
      class="bg-sky-500/10 text-sky-400 p-3 rounded-lg hidden sm:block"
    >
      <i class="fa-solid fa-users fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Users</p>
      <h3
        id="total-users-stat"
        class="text-xl sm:text-2xl font-bold text-white"
      >
        8
      </h3>
    </div>
  </div>
  <div
    id="card-resellers"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-purple-400"
  >
    <div
      class="bg-purple-500/10 text-purple-400 p-3 rounded-lg hidden sm:block"
    >
      <i class="fa-solid fa-user-tag fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Resellers</p>
      <h3
        id="total-resellers-stat"
        class="text-xl sm:text-2xl font-bold text-white"
      >
        0
      </h3>
    </div>
  </div>
  
  <div
    id="card-connections"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-teal-400"
  >
    <div
      class="bg-teal-500/10 text-teal-400 p-3 rounded-lg hidden sm:block"
    >
      <i class="fa-solid fa-server fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Connections</p>
      <h3 class="text-base font-bold text-white">Manage</h3>
    </div>
  </div>
  <div
    id="card-plans"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-indigo-400"
  >
    <div class="bg-indigo-500/10 text-indigo-400 p-3 rounded-lg hidden sm:block">
      <i class="fa-solid fa-list-alt fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Plans</p>
      <h3 class="text-base font-bold text-white">Manage</h3>
    </div>
  </div>
  <div
    id="card-reports"
    class="glass-panel p-4 rounded-xl flex items-center gap-4 cursor-pointer transition-all border-2 border-transparent hover:border-pink-400"
  >
    <div class="bg-pink-500/10 text-pink-400 p-3 rounded-lg hidden sm:block">
      <i class="fa-solid fa-chart-line fa-lg"></i>
    </div>
    <div>
      <p class="text-xs sm:text-sm text-slate-400">Reports</p>
      <h3 class="text-base font-bold text-white">Generate</h3>
    </div>
  </div>
</section>
      <main id="main-content-area">
        <div
          class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-4"
        >
          <h2 id="content-title" class="text-xl font-bold text-white"></h2>
          <div class="flex items-center gap-4">
            <div id="auto-reload-container" class="flex items-center gap-2">
              <label
                for="auto-reload-checkbox"
                class="text-xs text-gray-400 cursor-pointer"
                >Auto-reload</label
              >
              <div class="relative inline-block w-10 align-middle select-none">
                <input
                  type="checkbox"
                  id="auto-reload-checkbox"
                  class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"
                />
                <label
                  for="auto-reload-checkbox"
                  class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-600 cursor-pointer"
                ></label>
              </div>
            </div>
            <button
              id="manual-reload-btn"
              class="text-slate-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-slate-700"
            >
              <i class="fa-solid fa-sync"></i>
            </button>
            <div id="search-bar-container" class="relative hidden">
              <i
                class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"
              ></i
              ><input
                type="text"
                id="search-input"
                class="bg-slate-800 border border-slate-700 rounded-lg pl-10 pr-3 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-purple-500 w-full sm:w-64"
                placeholder="Search..."
              />
            </div>
            <button id="add-new-btn" class="btn btn-approve hidden">
              <i class="fa-solid fa-plus"></i> Add New
            </button>
          </div>
        </div>
        <div id="content-container" class="space-y-4"></div>
      </main>
    </div>

    <!-- Modals -->
    <div
      id="image-modal"
      class="modal fixed inset-0 bg-black/80 justify-center items-center z-50 p-4"
    >
      <div class="p-4 bg-slate-900 rounded-lg max-w-4xl max-h-[90vh] relative">
        <button
          class="modal-close-btn absolute -top-4 -right-4 w-10 h-10 bg-red-600 rounded-full text-white text-xl z-10"
        >
          &times;
        </button>
        <img
          id="modal-image"
          src=""
          alt="Payment Proof"
          class="max-w-full max-h-[85vh] object-contain rounded"
        />
      </div>
    </div>

    <div
      id="settings-modal"
      class="modal fixed inset-0 bg-black/80 justify-center items-center z-50 p-4"
    >
      <div class="glass-panel w-full max-w-2xl p-6 rounded-lg relative">
        <button
          class="modal-close-btn absolute top-4 right-4 text-gray-400 hover:text-white text-2xl"
        >
          &times;
        </button>
        <h3 class="text-xl font-bold mb-6 font-['Orbitron']">
          Application Settings
        </h3>
        <div
          id="settings-modal-content"
          class="space-y-4 max-h-[70vh] overflow-y-auto"
        ></div>
        <button
          id="settings-modal-save-btn"
          class="btn btn-approve w-full justify-center mt-6"
        >
          Save Settings
        </button>
      </div>
    </div>
    
    <div
      id="form-modal"
      class="modal fixed inset-0 bg-black/80 justify-center items-center z-50 p-4"
    >
      <div class="glass-panel w-full max-w-lg p-6 rounded-lg relative">
        <button
          class="modal-close-btn absolute top-4 right-4 text-gray-400 hover:text-white text-2xl"
        >
          &times;
        </button>
        <h3
          id="form-modal-title"
          class="text-xl font-bold mb-6 font-['Orbitron']"
        ></h3>
        <form
          id="form-modal-content"
          class="space-y-4 max-h-[70vh] overflow-y-auto"
        ></form>
        <button
          id="form-modal-save-btn"
          class="btn btn-approve w-full justify-center mt-6"
        >
          Save Changes
        </button>
      </div>
    </div>
    
    <!-- Report Modal has been removed from here -->

    <script src="/js/admin.js"></script>
    <script>
      VANTA.WAVES({
        el: "#vanta-bg",
        mouseControls: true,
        touchControls: true,
        gyroControls: false,
        minHeight: 200.0,
        minWidth: 200.0,
        scale: 1.0,
        scaleMobile: 1.0,
        color: 0x20002f,
        shininess: 25.0,
        waveHeight: 15.0,
        waveSpeed: 0.65,
        zoom: 0.85,
      });
    </script>
  </body>
</html>
